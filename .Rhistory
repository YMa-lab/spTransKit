# Computational efficiency vs. number of genes
gene_runtime <- read.csv("Open-ST/Human_MLN_4/results/gene_runtime.csv", header = 1)
colnames(gene_runtime) <- c("Transformation", 1000, 5000, 10000, 15000, 20000, 25000, 30000, 35000, 40000, 44955)
gene_runtime <- gene_runtime %>% gather(Gene, Runtime, -Transformation)
gene_runtime$Gene <- as.integer(gene_runtime$Gene)
gene_memory <- read.csv("Open-ST/Human_MLN_4/results/gene_memory.csv", header = 1)
colnames(gene_memory) <- c("Transformation", 1000, 5000, 10000, 15000, 20000, 25000, 30000, 35000, 40000, 44955)
gene_memory <- gene_memory %>% gather(Gene, Memory, -Transformation)
gene_memory$Gene <- as.integer(gene_memory$Gene)
p3 <- ggplot(gene_runtime, aes(Gene, Runtime, color = Transformation)) +
geom_line(size = 2) +
theme(text = element_text(family = "Arial"),
axis.text = element_text(size = 20),
axis.title = element_text(size = 22),
legend.position = "none",
panel.grid = element_blank(),
panel.background = element_rect(color = "gray", fill = "white", size = 2)) +
scale_color_manual(values = palette) +
xlab("No. Genes") +
ylab("Runtime (s)")
p4 <- ggplot(gene_memory, aes(Gene, Memory, color = Transformation)) +
geom_line(size = 2) +
theme(text = element_text(family = "Arial"),
axis.text = element_text(size = 20),
axis.title = element_text(size = 22),
legend.position = "none",
panel.grid = element_blank(),
panel.background = element_rect(color = "gray", fill = "white", size = 2)) +
scale_color_manual(values = palette) +
xlab("No. Genes") +
ylab("Peak Memory Allocation (MB)")
p34 <- ggarrange(p3, NULL, p4, nrow = 1, ncol = 3, align = "v", widths = c(1, 0.05, 1))
ggarrange(p12, NULL, p34, nrow = 1, ncol = 3, align = "v", widths = c(1, 0.1, 0.8), common.legend = TRUE, legend.grob = get_legend(p1), legend = "bottom")
ggarrange(p1, NULL, p2, NULL, p3, NULL, p4, nrow = 1, ncol = 7, align = "v", widths = c(1, 0.1, 1, 0.1, 1, 0.1, 1), common.legend = TRUE, legend.grob = get_legend(p1), legend = "bottom")
p1 <- ggplot(spot_runtime, aes(Location, Runtime, color = Transformation)) +
geom_line(size = 2) +
theme(text = element_text(family = "Arial"),
axis.text = element_text(size = 20),
axis.title = element_text(size = 22),
legend.text = element_text(size = 20),
legend.title = element_text(size = 22, hjust = 0.5),
legend.position = "none",
legend.key = element_blank(),
legend.key.spacing.x = unit(0.1, "cm"),
panel.grid = element_blank(),
panel.background = element_rect(color = "gray", fill = "white", size = 2)) +
scale_color_manual(values = palette) +
xlab("No. Locations") +
ylab("Runtime (s)")
ggarrange(p1, NULL, p2, NULL, p3, NULL, p4, nrow = 1, ncol = 7, align = "v", widths = c(1, 0.1, 1, 0.1, 1, 0.1, 1), common.legend = TRUE, legend.grob = get_legend(p1), legend = "bottom")
p1 <- ggplot(spot_runtime, aes(Location, Runtime, color = Transformation)) +
geom_line(size = 2) +
theme(text = element_text(family = "Arial"),
axis.text = element_text(size = 20),
axis.title = element_text(size = 22),
legend.text = element_text(size = 20),
legend.title = element_text(size = 22, hjust = 0.5),
legend.position = "none",
legend.key = element_blank(),
legend.key.spacing.x = unit(0.5, "cm"),
panel.grid = element_blank(),
panel.background = element_rect(color = "gray", fill = "white", size = 2)) +
scale_color_manual(values = palette) +
xlab("No. Locations") +
ylab("Runtime (s)")
ggarrange(p1, NULL, p2, NULL, p3, NULL, p4, nrow = 1, ncol = 7, align = "v", widths = c(1, 0.1, 1, 0.1, 1, 0.1, 1), common.legend = TRUE, legend.grob = get_legend(p1), legend = "bottom")
ggarrange(p1, NULL, p2, get_legend(p1), p3, NULL, p4, nrow = 1, ncol = 7, align = "v", widths = c(1, 0.1, 1, 0.1, 1, 0.1, 1), legend = "none")
get_legend(p1)
get_legend(p1, "right")
ggarrange(p1, NULL, p2, get_legend(p1, "right"), p3, NULL, p4, nrow = 1, ncol = 7, align = "v", widths = c(1, 0.1, 1, 0.1, 1, 0.1, 1), legend = "none")
ggarrange(p1, NULL, p2, get_legend(p1, "right"), p3, NULL, p4, nrow = 1, ncol = 7, align = "v", widths = c(1, 0.1, 1, 0.1, 1, 0.1, 1))
ggarrange(p1, NULL, p2, get_legend(p1, "right"), p3, NULL, p4, nrow = 1, ncol = 7, align = "v", widths = c(1, 0.1, 1, 1, 1, 0.1, 1))
ggarrange(p1, NULL, p2, get_legend(p1, "right"), p3, NULL, p4, nrow = 1, ncol = 7, align = "v", widths = c(1, 0.1, 1, 0.5, 1, 0.1, 1))
p1 <- ggplot(spot_runtime, aes(Location, Runtime, color = Transformation)) +
geom_line(size = 2) +
theme(text = element_text(family = "Arial"),
axis.text = element_text(size = 20),
axis.title = element_text(size = 22),
legend.text = element_text(size = 20),
legend.title = element_text(size = 22, hjust = 0.5),
legend.position = "none",
legend.key = element_blank(),
legend.key.spacing.y = unit(0.5, "cm"),
panel.grid = element_blank(),
panel.background = element_rect(color = "gray", fill = "white", size = 2)) +
scale_color_manual(values = palette) +
xlab("No. Locations") +
ylab("Runtime (s)")
ggarrange(p1, NULL, p2, get_legend(p1, "right"), p3, NULL, p4, nrow = 1, ncol = 7, align = "v", widths = c(1, 0.1, 1, 0.5, 1, 0.1, 1))
ggarrange(p1, NULL, p2, get_legend(p1, "right"), p3, NULL, p4, nrow = 1, ncol = 7, align = "v", widths = c(1, 0.1, 1, 0.7, 1, 0.1, 1))
ggarrange(p1, p2, nrow = 1, ncol = 3, align = "v", widths = c(1, 0.1, 1)) +
ggtitle("10x Xenium Prime Human Prostate Cancer")
p12 <- ggarrange(p1, NULL, p2, nrow = 1, ncol = 3, align = "v", widths = c(1, 0.1, 1)) +
ggtitle("10x Xenium Prime Human Prostate Cancer")
ggarrange(p1, NULL, p2, nrow = 1, ncol = 3, align = "v", widths = c(1, 0.1, 1))
p12 <- ggarrange(p1, NULL, p2, nrow = 1, ncol = 3, align = "v", widths = c(1, 0.1, 1))
annotate_figure(p12, top = text_grob("10x Xenium Prime", face = "bold", size = "24"))
annotate_figure(p12, top = text_grob("10x Xenium Prime Human Prostate Cancer", face = "bold", size = "24"))
p12 <- annotate_figure(p12, top = text_grob("10x Xenium Prime Human Prostate Cancer", face = "bold", size = "24"))
p34 <- ggarrange(p3, NULL, p4, nrow = 1, ncol = 3, widths = c(1, 0.1, 1))
p34 <- annotate_figure(p34, top = text_grob("Open-ST Metastatic Lymph Node", face = "bold", size = "24"))
ggarrange(p12, get_legend(p1, "right"), p34, nrow = 1, ncol = 3, align = "v", widths = c(1, 0.7, 1))
ggarrange(p12, get_legend(p1, "right"), p34, nrow = 1, ncol = 3, align = "v", widths = c(1, 0.5, 1))
ggarrange(p12, get_legend(p1, "right"), p34, nrow = 1, ncol = 3, align = "v", widths = c(1, 0.3, 1))
p12 <- ggarrange(p1, NULL, p2, nrow = 1, ncol = 3, align = "v", widths = c(1, 0.1, 1))
p12 <- annotate_figure(p12, top = text_grob("10x Xenium Prime Human Prostate Cancer", face = "bold", size = "24", family = "Arial"))
# Computational efficiency vs. number of genes
gene_runtime <- read.csv("Open-ST/Human_MLN_4/results/gene_runtime.csv", header = 1)
colnames(gene_runtime) <- c("Transformation", 1000, 5000, 10000, 15000, 20000, 25000, 30000, 35000, 40000, 44955)
gene_runtime <- gene_runtime %>% gather(Gene, Runtime, -Transformation)
gene_runtime$Gene <- as.integer(gene_runtime$Gene)
gene_memory <- read.csv("Open-ST/Human_MLN_4/results/gene_memory.csv", header = 1)
colnames(gene_memory) <- c("Transformation", 1000, 5000, 10000, 15000, 20000, 25000, 30000, 35000, 40000, 44955)
gene_memory <- gene_memory %>% gather(Gene, Memory, -Transformation)
gene_memory$Gene <- as.integer(gene_memory$Gene)
p3 <- ggplot(gene_runtime, aes(Gene, Runtime, color = Transformation)) +
geom_line(size = 2) +
theme(text = element_text(family = "Arial"),
axis.text = element_text(size = 20),
axis.title = element_text(size = 22),
legend.position = "none",
panel.grid = element_blank(),
panel.background = element_rect(color = "gray", fill = "white", size = 2)) +
scale_color_manual(values = palette) +
xlab("No. Genes") +
ylab("Runtime (s)")
p4 <- ggplot(gene_memory, aes(Gene, Memory, color = Transformation)) +
geom_line(size = 2) +
theme(text = element_text(family = "Arial"),
axis.text = element_text(size = 20),
axis.title = element_text(size = 22),
legend.position = "none",
panel.grid = element_blank(),
panel.background = element_rect(color = "gray", fill = "white", size = 2)) +
scale_color_manual(values = palette) +
xlab("No. Genes") +
ylab("Peak Memory Allocation (MB)")
p34 <- ggarrange(p3, NULL, p4, nrow = 1, ncol = 3, widths = c(1, 0.1, 1))
p34 <- annotate_figure(p34, top = text_grob("Open-ST Metastatic Lymph Node", face = "bold", size = "24", family = "Arial"))
ggarrange(p12, get_legend(p1, "right"), p34, nrow = 1, ncol = 3, align = "v", widths = c(1, 0.3, 1))
sf <- read.csv("/Volumes/home/Transformations/sfrplots.csv")
palette <- c("#ffe5d4", "#94d2bd", "#c98986", "#f7c685", "#bacceb", "#ff4374ff",
"#2d739eff", "#E9BFBA", "#268785", "#FFD92F", "#be9b72ff", "#A0A0B0",
"#E31A1C", "#ff8383ff", "#e07a5f", "#CBDFBD")
cc <- read.csv("/Volumes/home/Transformations/ccrplots.csv")
p2 <- ggplot(data[data$Analysis == "Count Correspondence", ],
aes(reorder(Transformation, Rank, FUN = mean, decreasing = FALSE), Rank)) +
geom_point(color = "gray", position = position_jitter(width = 0.2)) +
stat_summary(geom = "point", fun.y = "mean", fill = palette, pch = 21, col = "black", size = 6) +
theme_bw() +
theme(axis.text.x = element_text(),
axis.title.y = element_blank(),
axis.text.y = element_text(),
panel.grid = element_blank(),
panel.background = element_rect(fill = "white", color = "white")) +
scale_size_area(max_size = 10) +
ylab("Normalized Rank") +
coord_flip()
p1 <- ggplot(data[data$Analysis == "Size Factor Correspondence", ],
aes(reorder(Transformation, Rank, FUN = mean, decreasing = FALSE), Rank)) +
geom_point(color = "gray", position = position_jitter(width = 0.2)) +
stat_summary(geom = "point", fun.y = "mean", fill = palette, pch = 21, col = "black", size = 6) +
theme_bw() +
theme(axis.text.x = element_text(),
axis.title.y = element_blank(),
axis.text.y = element_text(),
panel.grid = element_blank(),
panel.background = element_rect(fill = "white", color = "white")) +
scale_size_area(max_size = 10) +
ylab("Normalized Rank") +
coord_flip()
p2 <- ggplot(data[data$Analysis == "Count Correspondence", ],
aes(reorder(Transformation, Rank, FUN = mean, decreasing = FALSE), Rank)) +
geom_point(color = "gray", position = position_jitter(width = 0.2)) +
stat_summary(geom = "point", fun.y = "mean", fill = palette, pch = 21, col = "black", size = 6) +
theme_bw() +
theme(text = element_text(family = "Arial"),
axis.text.x = element_text(size = 20),
axis.title.x = element_text(size = 22),
axis.title.y = element_blank(),
axis.text.y = element_text(size = 20),
panel.grid = element_blank(),
panel.background = element_rect(fill = "white", color = "gray", size = 2)) +
scale_size_area(max_size = 10) +
ylab("Normalized Rank") +
coord_flip()
p1 <- ggplot(data[data$Analysis == "Size Factor Correspondence", ],
aes(reorder(Transformation, Rank, FUN = mean, decreasing = FALSE), Rank)) +
geom_point(color = "gray", position = position_jitter(width = 0.2)) +
stat_summary(geom = "point", fun.y = "mean", fill = palette, pch = 21, col = "black", size = 6) +
theme(text = element_text(family = "Arial"),
axis.text.x = element_text(size = 20),
axis.title.x = element_text(size = 22),
axis.title.y = element_blank(),
axis.text.y = element_text(size = 20),
panel.grid = element_blank(),
panel.background = element_rect(fill = "white", color = "gray", size = 2)) +
scale_size_area(max_size = 10) +
ylab("Normalized Rank") +
coord_flip()
ggarrange(p1, NULL, p2, nrow = 1, ncol = 3, widths = c(1, 0.1, 1))
p2 <- ggplot(data[data$Analysis == "Count Correspondence", ],
aes(reorder(Transformation, Rank, FUN = mean, decreasing = FALSE), Rank)) +
geom_point(color = "gray", position = position_jitter(width = 0.2)) +
stat_summary(geom = "point", fun.y = "mean", fill = palette, pch = 21, col = "black", size = 6) +
theme(text = element_text(family = "Arial"),
axis.text.x = element_text(size = 20),
axis.title.x = element_text(size = 22),
axis.title.y = element_blank(),
axis.text.y = element_text(size = 20),
panel.grid = element_blank(),
panel.background = element_rect(fill = "white", color = "gray", size = 2)) +
scale_size_area(max_size = 10) +
ylab("Normalized Rank") +
coord_flip()
ggarrange(p1, NULL, p2, nrow = 1, ncol = 3, widths = c(1, 0.1, 1))
p2 <- ggplot(data[data$Analysis == "Count Correspondence", ],
aes(reorder(Transformation, Rank, FUN = mean, decreasing = FALSE), Rank)) +
geom_point(color = "gray", position = position_jitter(width = 0.3)) +
stat_summary(geom = "point", fun.y = "mean", fill = palette, pch = 21, col = "black", size = 7) +
theme(text = element_text(family = "Arial"),
axis.text.x = element_text(size = 20),
axis.title.x = element_text(size = 22),
axis.title.y = element_blank(),
axis.text.y = element_text(size = 20),
panel.grid = element_blank(),
panel.background = element_rect(fill = "white", color = "gray", size = 2)) +
scale_size_area(max_size = 15) +
ylab("Normalized Rank") +
coord_flip()
p1 <- ggplot(data[data$Analysis == "Size Factor Correspondence", ],
aes(reorder(Transformation, Rank, FUN = mean, decreasing = FALSE), Rank)) +
geom_point(color = "gray", position = position_jitter(width = 0.3)) +
stat_summary(geom = "point", fun.y = "mean", fill = palette, pch = 21, col = "black", size = 7) +
theme(text = element_text(family = "Arial"),
axis.text.x = element_text(size = 20),
axis.title.x = element_text(size = 22),
axis.title.y = element_blank(),
axis.text.y = element_text(size = 20),
panel.grid = element_blank(),
panel.background = element_rect(fill = "white", color = "gray", size = 2)) +
scale_size_area(max_size = 15) +
ylab("Normalized Rank") +
coord_flip()
ggarrange(p1, NULL, p2, nrow = 1, ncol = 3, widths = c(1, 0.1, 1))
p1 <- ggplot(data[data$Analysis == "Size Factor Correspondence", ],
aes(reorder(Transformation, Rank, FUN = mean, decreasing = FALSE), Rank)) +
geom_point(color = "gray", position = position_jitter(width = 0.2)) +
stat_summary(geom = "point", fun.y = "mean", fill = palette, pch = 21, col = "black", size = 7) +
theme(text = element_text(family = "Arial"),
axis.text.x = element_text(size = 20),
axis.title.x = element_text(size = 22),
axis.title.y = element_blank(),
axis.text.y = element_text(size = 20),
panel.grid = element_blank(),
panel.background = element_rect(fill = "white", color = "gray", size = 2)) +
scale_size_area(max_size = 15) +
ylab("Normalized Rank") +
coord_flip()
p2 <- ggplot(data[data$Analysis == "Count Correspondence", ],
aes(reorder(Transformation, Rank, FUN = mean, decreasing = FALSE), Rank)) +
geom_point(color = "gray", position = position_jitter(width = 0.2)) +
stat_summary(geom = "point", fun.y = "mean", fill = palette, pch = 21, col = "black", size = 7) +
theme(text = element_text(family = "Arial"),
axis.text.x = element_text(size = 20),
axis.title.x = element_text(size = 22),
axis.title.y = element_blank(),
axis.text.y = element_text(size = 20),
panel.grid = element_blank(),
panel.background = element_rect(fill = "white", color = "gray", size = 2)) +
scale_size_area(max_size = 15) +
ylab("Normalized Rank") +
coord_flip()
ggarrange(p1, NULL, p2, nrow = 1, ncol = 3, widths = c(1, 0.1, 1))
ggplot(mgd, aes(x, -y, color = SNAP25)) +
geom_point(size = 2) +
theme(text = element_text(family = "Arial"),
axis.title.x = element_text(size = 22),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_text(size = 22),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
panel.grid = element_blank(),
strip.background = element_rect(color = "gray", fill = "gray", size = 2),
strip.text = element_text(face = "bold", size = 22),
legend.position = "bottom",
legend.text = element_text(size = 20),
legend.title = element_text(size = 22, hjust = 0.5),
legend.ticks = element_blank(),
legend.title.position = "top",
legend.key.width = unit(1.5, "cm"),
panel.background = element_rect(color = "gray", fill = "white", size = 2)) +
facet_wrap(~ factor(Transformation, levels = c("log(y/s + 1/4α)", "scanpy Pearson Residual", "Analytic Pearson", "DESeq2", "scanpy Zheng", "CPM", "y/s", "PsiNorm", "log(y/s + 1)", "scanpy Weinreb", "acosh(2αy/s + 1)", "Normalisr", "scanpy Seurat", "TMM", "log(y/s + 1)/u", "log(CPM + 1)")), scales = "free", nrow = 2, ncol = 8) +
panel_border() +
scale_color_viridis_c(option = "turbo") +
xlab("X Coordinate") +
ylab("Y Coordinate") +
labs(color = "SNAP25 Expression")
mgd <- read.csv("/Volumes/home/Transformations/mgdrplots.csv")
View(mgd)
ggplot(mgd, aes(x, -y, color = SNAP25)) +
geom_point(size = 2) +
theme(text = element_text(family = "Arial"),
axis.title.x = element_text(size = 22),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_text(size = 22),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
panel.grid = element_blank(),
strip.background = element_rect(color = "gray", fill = "gray", size = 2),
strip.text = element_text(face = "bold", size = 22),
legend.position = "bottom",
legend.text = element_text(size = 20),
legend.title = element_text(size = 22, hjust = 0.5),
legend.ticks = element_blank(),
legend.title.position = "top",
legend.key.width = unit(1.5, "cm"),
panel.background = element_rect(color = "gray", fill = "white", size = 2)) +
facet_wrap(~ factor(Transformation, levels = c("log(y/s + 1/4α)", "scanpy Pearson Residual", "Analytic Pearson", "DESeq2", "scanpy Zheng", "CPM", "y/s", "PsiNorm", "log(y/s + 1)", "scanpy Weinreb", "acosh(2αy/s + 1)", "Normalisr", "scanpy Seurat", "TMM", "log(y/s + 1)/u", "log(CPM + 1)")), scales = "free", nrow = 2, ncol = 8) +
panel_border() +
scale_color_viridis_c(option = "turbo") +
xlab("X Coordinate") +
ylab("Y Coordinate") +
labs(color = "SNAP25 Expression")
ggplot(mgd, aes(x, -y, color = PCP4)) +
geom_point(size = 2) +
theme(text = element_text(family = "Arial"),
axis.title.x = element_text(size = 22),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_text(size = 22),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
panel.grid = element_blank(),
strip.background = element_rect(color = "gray", fill = "gray", size = 2),
strip.text = element_text(face = "bold", size = 22),
legend.position = "bottom",
legend.text = element_text(size = 20),
legend.title = element_text(size = 22, hjust = 0.5),
legend.ticks = element_blank(),
legend.title.position = "top",
legend.key.width = unit(1.5, "cm"),
panel.background = element_rect(color = "gray", fill = "white", size = 2)) +
facet_wrap(~ factor(Transformation, levels = c("log(y/s + 1/4α)", "scanpy Pearson Residual", "Analytic Pearson", "DESeq2", "scanpy Zheng", "CPM", "y/s", "PsiNorm", "log(y/s + 1)", "scanpy Weinreb", "acosh(2αy/s + 1)", "Normalisr", "scanpy Seurat", "TMM", "log(y/s + 1)/u", "log(CPM + 1)")), scales = "free", nrow = 2, ncol = 8) +
panel_border() +
scale_color_viridis_c(option = "turbo") +
xlab("X Coordinate") +
ylab("Y Coordinate") +
labs(color = "PCP4 Expression")
sf <- read.csv("/Volumes/home/Transformations/sfrplots.csv")
ggplot(sf, aes(Full, Reduced)) +
geom_point(color = "#723D46") +
theme(text = element_text(family = "Arial"),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.x = element_text(size = 22),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.title.y = element_text(size = 22),
legend.position = "none",
strip.text = element_text(size = 22, face = "bold"),
strip.background = element_rect(color = "gray", fill = "gray", size = 2),
panel.grid = element_blank(),
panel.background = element_rect(color = "gray", fill = "white", size = 2)) +
facet_wrap(~ factor(Transformation, levels = c("log(CPM + 1)", "acosh(2αy/s + 1)", "TMM", "Normalisr", "scanpy Seurat", "log(y/s + 1)", "scanpy Zheng", "log(y/s + 1/4α)", "DESeq2", "PsiNorm", "scanpy Pearson Residual", "Analytic Pearson", "log(y/s + 1)/u", "CPM", "y/s", "scanpy Weinreb")), scales = "free", nrow = 2, ncol = 8) +
geom_abline(intercept = 0, slope = 1, color = "red") +
panel_border() +
xlab("Full Gene Panel") +
ylab("Reduced Gene Panel")
library(ggplot2)
library(tidytext)
library(tidyr)
library(gridExtra)
library(cowplot)
library(forcats)
library(patchwork)
library(ggpubr)
library(showtext)
library(extrafont)
library(stringr)
library(scales)
ggplot(sf, aes(Full, Reduced)) +
geom_point(color = "#723D46") +
theme(text = element_text(family = "Arial"),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.x = element_text(size = 22),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.title.y = element_text(size = 22),
legend.position = "none",
strip.text = element_text(size = 22, face = "bold"),
strip.background = element_rect(color = "gray", fill = "gray", size = 2),
panel.grid = element_blank(),
panel.background = element_rect(color = "gray", fill = "white", size = 2)) +
facet_wrap(~ factor(Transformation, levels = c("log(CPM + 1)", "acosh(2αy/s + 1)", "TMM", "Normalisr", "scanpy Seurat", "log(y/s + 1)", "scanpy Zheng", "log(y/s + 1/4α)", "DESeq2", "PsiNorm", "scanpy Pearson Residual", "Analytic Pearson", "log(y/s + 1)/u", "CPM", "y/s", "scanpy Weinreb")), scales = "free", nrow = 2, ncol = 8) +
geom_abline(intercept = 0, slope = 1, color = "red") +
panel_border() +
xlab("Full Gene Panel") +
ylab("Reduced Gene Panel")
ggplot(sf, aes(Full, Reduced)) +
geom_point(color = "#723D46") +
theme(text = element_text(family = "Arial"),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.x = element_text(size = 22),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.title.y = element_text(size = 22),
legend.position = "none",
strip.text = element_text(size = 22, face = "bold"),
strip.background = element_rect(color = "gray", fill = "gray", linewidth = 2),
panel.grid = element_blank(),
panel.background = element_rect(color = "gray", fill = "white", linewdith = 2)) +
facet_wrap(~ factor(Transformation, levels = c("log(CPM + 1)", "acosh(2αy/s + 1)", "TMM", "Normalisr", "scanpy Seurat", "log(y/s + 1)", "scanpy Zheng", "log(y/s + 1/4α)", "DESeq2", "PsiNorm", "scanpy Pearson Residual", "Analytic Pearson", "log(y/s + 1)/u", "CPM", "y/s", "scanpy Weinreb")), scales = "free", nrow = 2, ncol = 8) +
geom_abline(intercept = 0, slope = 1, color = "red") +
panel_border() +
xlab("Full Gene Panel") +
ylab("Reduced Gene Panel")
ggplot(sf, aes(Full, Reduced)) +
geom_point(color = "#723D46") +
theme(text = element_text(family = "Arial"),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.x = element_text(size = 22),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.title.y = element_text(size = 22),
legend.position = "none",
strip.text = element_text(size = 22, face = "bold"),
strip.background = element_rect(color = "gray", fill = "gray", linewidth = 2),
panel.grid = element_blank(),
panel.background = element_rect(color = "gray", fill = "white", linewidth = 2)) +
facet_wrap(~ factor(Transformation, levels = c("log(CPM + 1)", "acosh(2αy/s + 1)", "TMM", "Normalisr", "scanpy Seurat", "log(y/s + 1)", "scanpy Zheng", "log(y/s + 1/4α)", "DESeq2", "PsiNorm", "scanpy Pearson Residual", "Analytic Pearson", "log(y/s + 1)/u", "CPM", "y/s", "scanpy Weinreb")), scales = "free", nrow = 2, ncol = 8) +
geom_abline(intercept = 0, slope = 1, color = "red") +
panel_border() +
xlab("Full Gene Panel") +
ylab("Reduced Gene Panel")
cc <- read.csv("/Volumes/home/Transformations/ccrplots.csv")
plot <- cc[cc$Gene == "SNAP25", ]
ggplot(plot, aes(Full, Reduced)) +
geom_point(color = "#C9CBA3") +
theme(text = element_text(family = "Arial"),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.x = element_text(size = 22),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.title.y = element_text(size = 22),
legend.position = "none",
strip.text = element_text(size = 22, face = "bold"),
strip.background = element_rect(color = "gray", fill = "gray", linewidth = 2),
panel.grid = element_blank(),
panel.background = element_rect(color = "gray", fill = "white", linewidth = 2)) +
facet_wrap(~ factor(Transformation, levels = c("Normalisr", "acosh(2αy/s + 1)", "log(y/s + 1)", "scanpy Pearson Residual", "scanpy Zheng", "Analytic Pearson", "log(y/s + 1/4α)", "log(CPM + 1)", "PsiNorm", "scanpy Weinreb", "CPM", "y/s", "DESeq2", "log(y/s + 1)/u", "TMM", "scanpy Seurat")), scales = "free", nrow = 2, ncol = 8) +
geom_abline(intercept = 0, slope = 1, color = "red") +
panel_border() +
xlab("Full Gene Panel") +
ylab("Reduced Gene Panel")
plot <- cc[cc$Gene == "MOBP", ]
ggplot(plot, aes(Full, Reduced)) +
geom_point(color = "#C9CBA3") +
theme(text = element_text(family = "Arial"),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.x = element_text(size = 22),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.title.y = element_text(size = 22),
legend.position = "none",
strip.text = element_text(size = 22, face = "bold"),
strip.background = element_rect(color = "gray", fill = "gray", linewidth = 2),
panel.grid = element_blank(),
panel.background = element_rect(color = "gray", fill = "white", linewidth = 2)) +
facet_wrap(~ factor(Transformation, levels = c("Normalisr", "acosh(2αy/s + 1)", "log(y/s + 1)", "scanpy Pearson Residual", "scanpy Zheng", "Analytic Pearson", "log(y/s + 1/4α)", "log(CPM + 1)", "PsiNorm", "scanpy Weinreb", "CPM", "y/s", "DESeq2", "log(y/s + 1)/u", "TMM", "scanpy Seurat")), scales = "free", nrow = 2, ncol = 8) +
geom_abline(intercept = 0, slope = 1, color = "red") +
panel_border() +
xlab("Full Gene Panel") +
ylab("Reduced Gene Panel")
plot <- cc[cc$Gene == "PCP4", ]
ggplot(plot, aes(Full, Reduced)) +
geom_point(color = "#C9CBA3") +
theme(text = element_text(family = "Arial"),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.x = element_text(size = 22),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.title.y = element_text(size = 22),
legend.position = "none",
strip.text = element_text(size = 22, face = "bold"),
strip.background = element_rect(color = "gray", fill = "gray", linewidth = 2),
panel.grid = element_blank(),
panel.background = element_rect(color = "gray", fill = "white", linewidth = 2)) +
facet_wrap(~ factor(Transformation, levels = c("Normalisr", "acosh(2αy/s + 1)", "log(y/s + 1)", "scanpy Pearson Residual", "scanpy Zheng", "Analytic Pearson", "log(y/s + 1/4α)", "log(CPM + 1)", "PsiNorm", "scanpy Weinreb", "CPM", "y/s", "DESeq2", "log(y/s + 1)/u", "TMM", "scanpy Seurat")), scales = "free", nrow = 2, ncol = 8) +
geom_abline(intercept = 0, slope = 1, color = "red") +
panel_border() +
xlab("Full Gene Panel") +
ylab("Reduced Gene Panel")
setwd("Desktop/spTransKit")
library(anndata)
library(transformGamPoi)
library(Matrix)
data <- t(as.matrix(read_h5ad("raw.h5ad")))
data
sf <- colSums(data) / mean(colsums(data))
sf <- colSums(data) / mean(colSums(data))
sf <- unname(sf)
alpha <- shifted_log_transform(data, size_factors = sf)
write_h5ad(AnnData(alpha), "tests/pseudo_shifted_log_tgp.h5ad", compression = "gzip")
